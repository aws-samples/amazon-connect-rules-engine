{
  "Version": "2019-10-30",
  "StartAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
  "Metadata": {
    "entryPointPosition": {
      "x": 15,
      "y": 148
    },
    "snapToGrid": false,
    "ActionMetadata": {
      "b2e9b70e-7e5a-44e5-ba9f-de5fcc80c30a": {
        "position": {
          "x": 477,
          "y": 455
        },
        "useDynamic": true,
        "useDynamicForEncryptionKeys": true,
        "useDynamicForTerminatorDigits": false,
        "countryCodePrefix": "+1"
      },
      "a74f2fc4-ef3d-4b8a-836d-cf35cecbe563": {
        "position": {
          "x": 477,
          "y": 222
        },
        "useDynamic": true,
        "useDynamicForEncryptionKeys": true,
        "useDynamicForTerminatorDigits": false,
        "countryCodePrefix": "+1"
      },
      "99950efa-90e3-42f9-b311-82ad01206cb2": {
        "position": {
          "x": 473,
          "y": 15
        },
        "useDynamic": true,
        "useDynamicForEncryptionKeys": true,
        "useDynamicForTerminatorDigits": false,
        "countryCodePrefix": "+1"
      },
      "6e185ad4-af56-4267-8b21-1f90f35c3dda": {
        "position": {
          "x": 1218,
          "y": 268
        },
        "conditionMetadata": [
          {
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "true",
            "id": "e0d63f94-5372-49a4-9984-5a3ced4c1ebe"
          }
        ]
      },
      "b9a2a5c9-ccda-498e-af91-5bfee1c334fa": {
        "position": {
          "x": 2698,
          "y": 367
        },
        "useDynamic": false,
        "ContactFlow": {
          "id": "{{contactFlows.RulesEngineMain.arn}}",
          "text": "RulesEngineMain"
        }
      },
      "1da46932-c28d-4c63-a420-69c8d13cfe92": {
        "position": {
          "x": 774,
          "y": 219
        },
        "dynamicMetadata": {
          "selectedOption": true
        },
        "useDynamic": false
      },
      "cd59796e-35a1-404e-acc1-502c03d00135": {
        "position": {
          "x": 724,
          "y": 813
        },
        "dynamicMetadata": {
          "key1": false,
          "value1": false
        },
        "useDynamic": false
      },
      "2fb6475a-483b-4100-8b76-af48f706fc0d": {
        "position": {
          "x": 3032,
          "y": 718
        },
        "useDynamic": false,
        "ContactFlow": {
          "id": "{{contactFlows.RulesEngineError.arn}}",
          "text": "RulesEngineError"
        }
      },
      "76c95b63-e1f5-4901-b488-d350f47d35c4": {
        "position": {
          "x": 3365,
          "y": 830
        }
      },
      "84a7da70-4cab-4051-8c8a-d470d64da553": {
        "position": {
          "x": 1272,
          "y": 1558
        },
        "conditionMetadata": [
          {
            "id": "d415a5f4-408a-4450-938e-9799e33b906d",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "1"
          },
          {
            "id": "2daadf04-49cd-4555-aa94-423c628f04fb",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "2"
          },
          {
            "id": "ab4ac49f-3c2e-49cc-a9f6-5a94b035c72e",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "3"
          }
        ]
      },
      "857de24e-e365-4396-96c8-bff6043a2c7e": {
        "position": {
          "x": 1971,
          "y": 967
        },
        "useDynamic": true
      },
      "8a4622aa-2fce-4862-8f73-bf9551c4a7e5": {
        "position": {
          "x": 1957,
          "y": 1134
        },
        "useDynamic": true
      },
      "8d91f7b9-f3d3-4d84-bc6e-ee26d0f71623": {
        "position": {
          "x": 1661,
          "y": 1096
        },
        "conditionMetadata": [
          {
            "id": "891e762e-8a4b-4f06-8479-f10eaa48bb30",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "ssml"
          },
          {
            "id": "43f689bb-9aab-4d59-8421-5e8a58fae20b",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "prompt"
          }
        ]
      },
      "8c08c449-9fcf-4dbf-9aca-fc90c14de742": {
        "position": {
          "x": 1951,
          "y": 1312
        },
        "useDynamic": true
      },
      "9f166ed3-f927-45cd-b0e8-5180efae7f82": {
        "position": {
          "x": 1972,
          "y": 1508
        },
        "useDynamic": true
      },
      "6c739625-004f-4244-9a78-f8527fe887d6": {
        "position": {
          "x": 1973,
          "y": 1656
        },
        "useDynamic": true
      },
      "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba": {
        "position": {
          "x": 212,
          "y": 198
        },
        "conditionMetadata": [
          {
            "id": "eb951912-1f7b-4b34-97bf-882826fd840c",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "ssml"
          },
          {
            "id": "a2ea5722-2df1-4eed-91c2-f178f3c458b1",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "prompt"
          }
        ]
      },
      "098e844e-e717-4ce7-a278-cfdb704d89c1": {
        "position": {
          "x": 1697.1697998046875,
          "y": 1608.9656982421875
        },
        "conditionMetadata": [
          {
            "id": "0c36d494-f007-4002-9293-1cfd8eb6c73a",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "ssml"
          },
          {
            "id": "318d6ceb-ccfd-47e1-adcc-12f19270686e",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "prompt"
          }
        ]
      },
      "79576090-442a-49c5-8df3-8bc2ff6c595b": {
        "position": {
          "x": 1975,
          "y": 1819
        },
        "useDynamic": true
      },
      "5ff9cf96-ed2e-465f-ad1c-342b03d97bda": {
        "position": {
          "x": 1986,
          "y": 2085
        },
        "useDynamic": true
      },
      "96d574e1-4fe2-4182-ab8e-fd0b16919a8e": {
        "position": {
          "x": 2001,
          "y": 2254
        },
        "useDynamic": true
      },
      "059d276d-99cf-4dbb-a83a-e048e3b29e8c": {
        "position": {
          "x": 2415.794189453125,
          "y": 2232.7490234375
        },
        "dynamicMetadata": {
          "key1": false,
          "value1": true
        },
        "useDynamic": false
      },
      "c0f7953a-5004-4bb3-b2d5-bc601302be08": {
        "position": {
          "x": 1693,
          "y": 2167
        },
        "conditionMetadata": [
          {
            "id": "73d9d3de-b9f5-43fb-8585-e258c9ebe937",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "ssml"
          },
          {
            "id": "ecf9a896-5efe-47ae-b0c9-036c38326a78",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "prompt"
          }
        ]
      },
      "6af1c8e4-a416-4748-8971-971aab2a5335": {
        "position": {
          "x": 1992,
          "y": 2427
        },
        "useDynamic": true
      }
    }
  },
  "Actions": [
    {
      "Identifier": "b2e9b70e-7e5a-44e5-ba9f-de5fcc80c30a",
      "Parameters": {
        "Text": "$.External.CurrentRule_offerMessage",
        "StoreInput": "True",
        "InputTimeLimitSeconds": "5",
        "InputValidation": {
          "CustomValidation": {
            "MaximumLength": "1"
          }
        },
        "DTMFConfiguration": {
          "DisableCancelKey": "False"
        }
      },
      "Transitions": {
        "NextAction": "1da46932-c28d-4c63-a420-69c8d13cfe92",
        "Errors": [
          {
            "NextAction": "cd59796e-35a1-404e-acc1-502c03d00135",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "GetParticipantInput"
    },
    {
      "Identifier": "a74f2fc4-ef3d-4b8a-836d-cf35cecbe563",
      "Parameters": {
        "PromptId": "$.External.CurrentRule_offerMessagePromptArn",
        "StoreInput": "True",
        "InputTimeLimitSeconds": "5",
        "InputValidation": {
          "CustomValidation": {
            "MaximumLength": "20"
          }
        },
        "DTMFConfiguration": {
          "DisableCancelKey": "False"
        }
      },
      "Transitions": {
        "NextAction": "1da46932-c28d-4c63-a420-69c8d13cfe92",
        "Errors": [
          {
            "NextAction": "cd59796e-35a1-404e-acc1-502c03d00135",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "GetParticipantInput"
    },
    {
      "Identifier": "99950efa-90e3-42f9-b311-82ad01206cb2",
      "Parameters": {
        "SSML": "$.External.CurrentRule_offerMessage",
        "StoreInput": "True",
        "InputTimeLimitSeconds": "5",
        "InputValidation": {
          "CustomValidation": {
            "MaximumLength": "20"
          }
        },
        "DTMFConfiguration": {
          "DisableCancelKey": "False"
        }
      },
      "Transitions": {
        "NextAction": "1da46932-c28d-4c63-a420-69c8d13cfe92",
        "Errors": [
          {
            "NextAction": "cd59796e-35a1-404e-acc1-502c03d00135",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "GetParticipantInput"
    },
    {
      "Identifier": "6e185ad4-af56-4267-8b21-1f90f35c3dda",
      "Parameters": {
        "ComparisonValue": "$.External.validSelection"
      },
      "Transitions": {
        "NextAction": "cd59796e-35a1-404e-acc1-502c03d00135",
        "Errors": [
          {
            "NextAction": "cd59796e-35a1-404e-acc1-502c03d00135",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "b9a2a5c9-ccda-498e-af91-5bfee1c334fa",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "true"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "b9a2a5c9-ccda-498e-af91-5bfee1c334fa",
      "Parameters": {
        "ContactFlowId": "{{contactFlows.RulesEngineMain.arn}}"
      },
      "Transitions": {
        "NextAction": "2fb6475a-483b-4100-8b76-af48f706fc0d",
        "Errors": [
          {
            "NextAction": "2fb6475a-483b-4100-8b76-af48f706fc0d",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "TransferToFlow"
    },
    {
      "Identifier": "1da46932-c28d-4c63-a420-69c8d13cfe92",
      "Parameters": {
        "LambdaFunctionARN": "{{lambdaFunctions.connectdtmfselector.arn}}",
        "InvocationTimeLimitSeconds": "7",
        "LambdaInvocationAttributes": {
          "selectedOption": "$.StoredCustomerInput"
        }
      },
      "Transitions": {
        "NextAction": "6e185ad4-af56-4267-8b21-1f90f35c3dda",
        "Errors": [
          {
            "NextAction": "2fb6475a-483b-4100-8b76-af48f706fc0d",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "InvokeLambdaFunction"
    },
    {
      "Identifier": "cd59796e-35a1-404e-acc1-502c03d00135",
      "Parameters": {
        "LambdaFunctionARN": "{{lambdaFunctions.connectupdatestate.arn}}",
        "InvocationTimeLimitSeconds": "7",
        "LambdaInvocationAttributes": {
          "key1": "CurrentRule_errorCount",
          "value1": "increment"
        }
      },
      "Transitions": {
        "NextAction": "84a7da70-4cab-4051-8c8a-d470d64da553",
        "Errors": [
          {
            "NextAction": "2fb6475a-483b-4100-8b76-af48f706fc0d",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "InvokeLambdaFunction"
    },
    {
      "Identifier": "2fb6475a-483b-4100-8b76-af48f706fc0d",
      "Parameters": {
        "ContactFlowId": "{{contactFlows.RulesEngineError.arn}}"
      },
      "Transitions": {
        "NextAction": "76c95b63-e1f5-4901-b488-d350f47d35c4",
        "Errors": [
          {
            "NextAction": "76c95b63-e1f5-4901-b488-d350f47d35c4",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "TransferToFlow"
    },
    {
      "Identifier": "76c95b63-e1f5-4901-b488-d350f47d35c4",
      "Type": "DisconnectParticipant",
      "Parameters": {},
      "Transitions": {}
    },
    {
      "Identifier": "84a7da70-4cab-4051-8c8a-d470d64da553",
      "Parameters": {
        "ComparisonValue": "$.External.CurrentRule_errorCount"
      },
      "Transitions": {
        "NextAction": "c0f7953a-5004-4bb3-b2d5-bc601302be08",
        "Errors": [
          {
            "NextAction": "c0f7953a-5004-4bb3-b2d5-bc601302be08",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "8d91f7b9-f3d3-4d84-bc6e-ee26d0f71623",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "098e844e-e717-4ce7-a278-cfdb704d89c1",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "2"
              ]
            }
          },
          {
            "NextAction": "c0f7953a-5004-4bb3-b2d5-bc601302be08",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "3"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "857de24e-e365-4396-96c8-bff6043a2c7e",
      "Parameters": {
        "SSML": "$.External.CurrentRule_errorMessage1"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "8a4622aa-2fce-4862-8f73-bf9551c4a7e5",
      "Parameters": {
        "PromptId": "$.External.CurrentRule_errorMessage1PromptArn"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "8d91f7b9-f3d3-4d84-bc6e-ee26d0f71623",
      "Parameters": {
        "ComparisonValue": "$.External.CurrentRule_errorMessage1Type"
      },
      "Transitions": {
        "NextAction": "8c08c449-9fcf-4dbf-9aca-fc90c14de742",
        "Errors": [
          {
            "NextAction": "8c08c449-9fcf-4dbf-9aca-fc90c14de742",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "857de24e-e365-4396-96c8-bff6043a2c7e",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ssml"
              ]
            }
          },
          {
            "NextAction": "8a4622aa-2fce-4862-8f73-bf9551c4a7e5",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "prompt"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "8c08c449-9fcf-4dbf-9aca-fc90c14de742",
      "Parameters": {
        "Text": "$.External.CurrentRule_errorMessage1"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "9f166ed3-f927-45cd-b0e8-5180efae7f82",
      "Parameters": {
        "SSML": "$.External.CurrentRule_errorMessage2"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "6c739625-004f-4244-9a78-f8527fe887d6",
      "Parameters": {
        "PromptId": "$.External.CurrentRule_errorMessage2PromptArn"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
      "Parameters": {
        "ComparisonValue": "$.External.CurrentRule_offerMessageType"
      },
      "Transitions": {
        "NextAction": "b2e9b70e-7e5a-44e5-ba9f-de5fcc80c30a",
        "Errors": [
          {
            "NextAction": "b2e9b70e-7e5a-44e5-ba9f-de5fcc80c30a",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "99950efa-90e3-42f9-b311-82ad01206cb2",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ssml"
              ]
            }
          },
          {
            "NextAction": "a74f2fc4-ef3d-4b8a-836d-cf35cecbe563",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "prompt"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "098e844e-e717-4ce7-a278-cfdb704d89c1",
      "Parameters": {
        "ComparisonValue": "$.External.CurrentRule_errorMessage2Type"
      },
      "Transitions": {
        "NextAction": "79576090-442a-49c5-8df3-8bc2ff6c595b",
        "Errors": [
          {
            "NextAction": "79576090-442a-49c5-8df3-8bc2ff6c595b",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "9f166ed3-f927-45cd-b0e8-5180efae7f82",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ssml"
              ]
            }
          },
          {
            "NextAction": "6c739625-004f-4244-9a78-f8527fe887d6",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "prompt"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "79576090-442a-49c5-8df3-8bc2ff6c595b",
      "Parameters": {
        "Text": "$.External.CurrentRule_errorMessage2"
      },
      "Transitions": {
        "NextAction": "a7c8defe-f3a4-4785-9ccd-bba1fe46d7ba",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "5ff9cf96-ed2e-465f-ad1c-342b03d97bda",
      "Parameters": {
        "SSML": "$.External.CurrentRule_errorMessage3"
      },
      "Transitions": {
        "NextAction": "059d276d-99cf-4dbb-a83a-e048e3b29e8c",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "96d574e1-4fe2-4182-ab8e-fd0b16919a8e",
      "Parameters": {
        "PromptId": "$.External.CurrentRule_errorMessage3PromptArn"
      },
      "Transitions": {
        "NextAction": "059d276d-99cf-4dbb-a83a-e048e3b29e8c",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    },
    {
      "Identifier": "059d276d-99cf-4dbb-a83a-e048e3b29e8c",
      "Parameters": {
        "LambdaFunctionARN": "{{lambdaFunctions.connectupdatestate.arn}}",
        "InvocationTimeLimitSeconds": "7",
        "LambdaInvocationAttributes": {
          "key1": "NextRuleSet",
          "value1": "$.External.CurrentRule_errorRuleSetName"
        }
      },
      "Transitions": {
        "NextAction": "b9a2a5c9-ccda-498e-af91-5bfee1c334fa",
        "Errors": [
          {
            "NextAction": "2fb6475a-483b-4100-8b76-af48f706fc0d",
            "ErrorType": "NoMatchingError"
          }
        ],
        "Conditions": []
      },
      "Type": "InvokeLambdaFunction"
    },
    {
      "Identifier": "c0f7953a-5004-4bb3-b2d5-bc601302be08",
      "Parameters": {
        "ComparisonValue": "$.External.CurrentRule_errorMessage3Type"
      },
      "Transitions": {
        "NextAction": "6af1c8e4-a416-4748-8971-971aab2a5335",
        "Errors": [
          {
            "NextAction": "6af1c8e4-a416-4748-8971-971aab2a5335",
            "ErrorType": "NoMatchingCondition"
          }
        ],
        "Conditions": [
          {
            "NextAction": "5ff9cf96-ed2e-465f-ad1c-342b03d97bda",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ssml"
              ]
            }
          },
          {
            "NextAction": "96d574e1-4fe2-4182-ab8e-fd0b16919a8e",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "prompt"
              ]
            }
          }
        ]
      },
      "Type": "Compare"
    },
    {
      "Identifier": "6af1c8e4-a416-4748-8971-971aab2a5335",
      "Parameters": {
        "Text": "$.External.CurrentRule_errorMessage3"
      },
      "Transitions": {
        "NextAction": "059d276d-99cf-4dbb-a83a-e048e3b29e8c",
        "Errors": [],
        "Conditions": []
      },
      "Type": "MessageParticipant"
    }
  ]
}
